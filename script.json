// ═══════════════════════════════════════════════════════════
//   NEXUS HUB - JAVASCRIPT
// ═══════════════════════════════════════════════════════════

document.addEventListener('DOMContentLoaded', function() {
    
    // ═══════════════════════════════════
    // PARTICLES
    // ═══════════════════════════════════
    
    const particlesContainer = document.getElementById('particles');
    const particleCount = 50;
    
    for (let i = 0; i < particleCount; i++) {
        createParticle();
    }
    
    function createParticle() {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
        particle.style.animationDelay = Math.random() * 15 + 's';
        particle.style.opacity = Math.random() * 0.5 + 0.2;
        
        const size = Math.random() * 4 + 2;
        particle.style.width = size + 'px';
        particle.style.height = size + 'px';
        
        // Random color between primary and secondary
        const colors = ['#FF6B35', '#4ECDC4', '#FF8C5A', '#6EE7DF'];
        particle.style.background = colors[Math.floor(Math.random() * colors.length)];
        
        particlesContainer.appendChild(particle);
    }
    
    // ═══════════════════════════════════
    // MOBILE MENU
    // ═══════════════════════════════════
    
    const mobileMenu = document.getElementById('mobileMenu');
    const mobileNav = document.getElementById('mobileNav');
    
    mobileMenu.addEventListener('click', function() {
        mobileNav.classList.toggle('active');
        const icon = mobileMenu.querySelector('i');
        icon.className = mobileNav.classList.contains('active') ? 'fas fa-times' : 'fas fa-bars';
    });
    
    // Close mobile menu when clicking a link
    mobileNav.querySelectorAll('a').forEach(link => {
        link.addEventListener('click', () => {
            mobileNav.classList.remove('active');
            mobileMenu.querySelector('i').className = 'fas fa-bars';
        });
    });
    
    // ═══════════════════════════════════
    // STATS COUNTER ANIMATION
    // ═══════════════════════════════════
    
    const stats = document.querySelectorAll('.stat-number');
    let statsAnimated = false;
    
    function animateStats() {
        if (statsAnimated) return;
        
        stats.forEach(stat => {
            const target = parseInt(stat.getAttribute('data-target'));
            const duration = 2000;
            const increment = target / (duration / 16);
            let current = 0;
            
            const updateCounter = () => {
                current += increment;
                if (current < target) {
                    stat.textContent = Math.floor(current).toLocaleString();
                    requestAnimationFrame(updateCounter);
                } else {
                    stat.textContent = target.toLocaleString() + (target === 99 ? '%' : '+');
                }
            };
            
            updateCounter();
        });
        
        statsAnimated = true;
    }
    
    // Intersection Observer for stats
    const statsObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                animateStats();
            }
        });
    }, { threshold: 0.5 });
    
    const statsSection = document.querySelector('.stats');
    if (statsSection) {
        statsObserver.observe(statsSection);
    }
    
    // ═══════════════════════════════════
    // FAQ ACCORDION
    // ═══════════════════════════════════
    
    const faqItems = document.querySelectorAll('.faq-item');
    
    faqItems.forEach(item => {
        const question = item.querySelector('.faq-question');
        
        question.addEventListener('click', () => {
            const isActive = item.classList.contains('active');
            
            // Close all items
            faqItems.forEach(i => i.classList.remove('active'));
            
            // Open clicked item if it wasn't active
            if (!isActive) {
                item.classList.add('active');
            }
        });
    });
    
    // ═══════════════════════════════════
    // SCRIPT MODAL
    // ═══════════════════════════════════
    
    const getScriptBtn = document.getElementById('getScriptBtn');
    const scriptModal = document.getElementById('scriptModal');
    const closeModal = document.getElementById('closeModal');
    const copyBtn = document.getElementById('copyBtn');
    const scriptCode = document.getElementById('scriptCode');
    const copySuccess = document.getElementById('copySuccess');
    
    getScriptBtn.addEventListener('click', () => {
        scriptModal.classList.add('active');
        document.body.style.overflow = 'hidden';
    });
    
    closeModal.addEventListener('click', () => {
        scriptModal.classList.remove('active');
        document.body.style.overflow = '';
    });
    
    scriptModal.querySelector('.modal-overlay').addEventListener('click', () => {
        scriptModal.classList.remove('active');
        document.body.style.overflow = '';
    });
    
    copyBtn.addEventListener('click', () => {
        navigator.clipboard.writeText(scriptCode.textContent).then(() => {
            copySuccess.classList.add('show');
            copyBtn.innerHTML = '<i class="fas fa-check"></i> Copied!';
            
            setTimeout(() => {
                copySuccess.classList.remove('show');
                copyBtn.innerHTML = '<i class="fas fa-copy"></i> Copy';
            }, 3000);
        });
    });
    
    // ═══════════════════════════════════
    // GAMES MODAL
    // ═══════════════════════════════════
    
    const gameSupportBtn = document.getElementById('gameSupportBtn');
    const gamesModal = document.getElementById('gamesModal');
    const closeGamesModal = document.getElementById('closeGamesModal');
    const gameSearch = document.getElementById('gameSearch');
    const gamesList = document.getElementById('gamesList');
    
    // Games data
    const games = [
        "Blox Fruits", "King Legacy", "Pet Simulator X", "Adopt Me",
        "Murder Mystery 2", "Brookhaven", "Dragon Ball Z Final Stand",
        "Anime Fighters Simulator", "All Star Tower Defense", "Shindo Life",
        "Arsenal", "Jailbreak", "Tower of Hell", "Piggy", "Bee Swarm Simulator",
        "Ninja Legends", "Bubble Gum Simulator", "Mining Simulator",
        "Island Royale", "Phantom Forces", "Counter Blox", "Da Hood",
        "Ro Ghoul", "Anime Fighting Simulator", "Grand Piece Online",
        "Your Bizarre Adventure", "A Universal Time", "Survive The Killer",
        "Speed Run 4", "Flee The Facility", "Natural Disaster Survival",
        "Vehicle Simulator", "Mad City", "Build A Boat", "Tapping Legends",
        "Power Simulator", "Super Power Fighting Simulator", "Legends Of Speed",
        "Dragon Adventures", "World Zero", "Dungeon Quest", "Saber Simulator",
        "Muscle Legends", "Big Paintball", "Zombie Attack", "Tower Defense Simulator",
        "Roblox High School", "Royal High", "Meep City", "Welcome to Bloxburg"
    ];
    
    function renderGames(filter = '') {
        gamesList.innerHTML = '';
        
        const filteredGames = games.filter(game => 
            game.toLowerCase().includes(filter.toLowerCase())
        );
        
        filteredGames.forEach(game => {
            const gameItem = document.createElement('div');
            gameItem.className = 'game-list-item';
            gameItem.innerHTML = `
                <i class="fas fa-gamepad"></i>
                <span>${game}</span>
                <div class="status"></div>
            `;
            gamesList.appendChild(gameItem);
        });
        
        if (filteredGames.length === 0) {
            gamesList.innerHTML = `
                <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: var(--text-muted);">
                    <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 15px; display: block;"></i>
                    No games found matching "${filter}"
                </div>
            `;
        }
    }
    
    gameSupportBtn.addEventListener('click', () => {
        gamesModal.classList.add('active');
        document.body.style.overflow = 'hidden';
        renderGames();
    });
    
    closeGamesModal.addEventListener('click', () => {
        gamesModal.classList.remove('active');
        document.body.style.overflow = '';
    });
    
    gamesModal.querySelector('.modal-overlay').addEventListener('click', () => {
        gamesModal.classList.remove('active');
        document.body.style.overflow = '';
    });
    
    gameSearch.addEventListener('input', (e) => {
        renderGames(e.target.value);
    });
    
    // ═══════════════════════════════════
    // SMOOTH SCROLL
    // ═══════════════════════════════════
    
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function(e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
    
    // ═══════════════════════════════════
    // NAVBAR SCROLL EFFECT
    // ═══════════════════════════════════
    
    const navbar = document.querySelector('.navbar');
    
    window.addEventListener('scroll', () => {
        if (window.scrollY > 50) {
            navbar.style.background = 'rgba(10, 10, 15, 0.95)';
            navbar.style.boxShadow = '0 5px 30px rgba(0, 0, 0, 0.3)';
        } else {
            navbar.style.background = 'rgba(10, 10, 15, 0.8)';
            navbar.style.boxShadow = 'none';
        }
    });
    
    // ═══════════════════════════════════
    // SCROLL REVEAL ANIMATION
    // ═══════════════════════════════════
    
    const revealElements = document.querySelectorAll('.feature-card, .game-card, .faq-item');
    
    const revealObserver = new IntersectionObserver((entries) => {
        entries.forEach((entry, index) => {
            if (entry.isIntersecting) {
                setTimeout(() => {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }, index * 100);
            }
        });
    }, { threshold: 0.1 });
    
    revealElements.forEach(el => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(30px)';
        el.style.transition = 'all 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
        revealObserver.observe(el);
    });
    
    // ═══════════════════════════════════
    // ESCAPE KEY TO CLOSE MODALS
    // ═══════════════════════════════════
    
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            scriptModal.classList.remove('active');
            gamesModal.classList.remove('active');
            document.body.style.overflow = '';
        }
    });
    
});